{"id":"node_modules/@snap/camera-kit/lib/events/scan.js","dependencies":[{"name":"/Users/eneto/Lab/snap-rca-camkit-workshop/node_modules/@snap/camera-kit/lib/events/scan.js.map","includedInParent":true,"mtime":1710948721301},{"name":"/Users/eneto/Lab/snap-rca-camkit-workshop/package.json","includedInParent":true,"mtime":1710952305120},{"name":"/Users/eneto/Lab/snap-rca-camkit-workshop/node_modules/@snap/camera-kit/package.json","includedInParent":true,"mtime":1710948721086},{"name":"./TypedCustomEvent","loc":{"line":1,"column":33,"index":33},"parent":"/Users/eneto/Lab/snap-rca-camkit-workshop/node_modules/@snap/camera-kit/lib/events/scan.js","resolved":"/Users/eneto/Lab/snap-rca-camkit-workshop/node_modules/@snap/camera-kit/lib/events/TypedCustomEvent.js"},{"name":"./TypedEventTarget","loc":{"line":2,"column":33,"index":88},"parent":"/Users/eneto/Lab/snap-rca-camkit-workshop/node_modules/@snap/camera-kit/lib/events/scan.js","resolved":"/Users/eneto/Lab/snap-rca-camkit-workshop/node_modules/@snap/camera-kit/lib/events/TypedEventTarget.js"}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.scan = void 0;\nvar _TypedCustomEvent = require(\"./TypedCustomEvent\");\nvar _TypedEventTarget = require(\"./TypedEventTarget\");\n/**\n * Each time an event is emitted, call a given accumulator function with two arguments: some state of type S and the\n * event. The accumulator returns a new state. `scan` returns a new event emitter which emits an event each time a new\n * state is produced by the accumulator.\n *\n * This can be used to implement a Redux-style state management architecture.\n *\n * @param seedState Some initial state, passed to the accumulator when the first event is emitted.\n * @returns A function which takes a source {@link TypedEventTarget}, a list of event types emitted by that target to\n * which to listen, and the accumulator function. The accumulator is called each time an event of the given type(s) is\n * emitted on the source. It is passed the current state and the event, and must return a new state.\n */\nconst scan = seedState => (source, eventTypes, accumulator) => {\n  let state = seedState;\n  const sink = new _TypedEventTarget.TypedEventTarget();\n  const listener = event => {\n    state = accumulator(state, event);\n    sink.dispatchEvent(new _TypedCustomEvent.TypedCustomEvent(\"state\", state));\n  };\n  // We'll use Proxies to make sure that event listeners are added/removed at the appropriate time.\n  // Callers can then control when to clean up the listeners we add here in a transparent way –\n  // by just removing the listener on the returned event target.\n  //\n  // We also prevent multiple listeners on the sink, as a simplification.\n  let hasListener = false;\n  sink.addEventListener = new Proxy(sink.addEventListener, {\n    apply: (target, thisArg, args) => {\n      if (hasListener) throw new Error(\"Cannot add another event listener. The TypedEventTarget returned by scan only \" + \"supports a single listener, and one has already been added.\");\n      hasListener = true;\n      eventTypes.forEach(eventType => source.addEventListener(eventType, listener));\n      target.apply(thisArg, args);\n    }\n  });\n  sink.removeEventListener = new Proxy(sink.removeEventListener, {\n    apply: (target, thisArg, args) => {\n      eventTypes.forEach(eventType => source.removeEventListener(eventType, listener));\n      target.apply(thisArg, args);\n    }\n  });\n  return sink;\n};\nexports.scan = scan;"},"sourceMaps":{"js":{"mappings":[{"source":"../../src/events/scan.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":7,"column":0}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":7,"column":4}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":7,"column":21}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":7,"column":24}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":7,"column":31}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":8,"column":0}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":8,"column":4}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":8,"column":21}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":8,"column":24}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":8,"column":31}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":9,"column":0}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":16,"column":7},"generated":{"line":21,"column":0}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":16,"column":13},"generated":{"line":21,"column":6}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":16,"column":17},"generated":{"line":21,"column":10}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":17,"column":8},"generated":{"line":21,"column":13}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":17,"column":20},"generated":{"line":21,"column":22}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":18,"column":4},"generated":{"line":21,"column":26}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":19,"column":8},"generated":{"line":21,"column":27}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":19,"column":22},"generated":{"line":21,"column":33}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":20,"column":8},"generated":{"line":21,"column":35}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":20,"column":31},"generated":{"line":21,"column":45}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":21,"column":8},"generated":{"line":21,"column":47}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":21,"column":75},"generated":{"line":21,"column":58}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":22,"column":56},"generated":{"line":21,"column":63}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":23,"column":8},"generated":{"line":22,"column":2}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":23,"column":12},"generated":{"line":22,"column":6}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":23,"column":17},"generated":{"line":22,"column":11}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":23,"column":20},"generated":{"line":22,"column":14}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":23,"column":29},"generated":{"line":22,"column":23}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":24,"column":8},"generated":{"line":23,"column":2}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":24,"column":14},"generated":{"line":23,"column":8}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":24,"column":18},"generated":{"line":23,"column":12}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":24,"column":21},"generated":{"line":23,"column":15}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":24,"column":25},"generated":{"line":23,"column":19}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":24,"column":41},"generated":{"line":23,"column":53}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":24,"column":41},"generated":{"line":23,"column":54}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":24,"column":73},"generated":{"line":23,"column":55}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":25,"column":8},"generated":{"line":24,"column":2}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":25,"column":14},"generated":{"line":24,"column":8}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":25,"column":22},"generated":{"line":24,"column":16}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":25,"column":26},"generated":{"line":24,"column":19}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":25,"column":49},"generated":{"line":24,"column":24}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":25,"column":53},"generated":{"line":24,"column":28}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":26,"column":12},"generated":{"line":25,"column":4}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":26,"column":17},"generated":{"line":25,"column":9}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":26,"column":20},"generated":{"line":25,"column":12}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":26,"column":31},"generated":{"line":25,"column":23}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":26,"column":32},"generated":{"line":25,"column":24}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":26,"column":37},"generated":{"line":25,"column":29}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":26,"column":39},"generated":{"line":25,"column":31}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":26,"column":78},"generated":{"line":25,"column":36}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":26,"column":79},"generated":{"line":25,"column":37}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":27,"column":12},"generated":{"line":26,"column":4}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":27,"column":16},"generated":{"line":26,"column":8}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":27,"column":17},"generated":{"line":26,"column":9}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":27,"column":30},"generated":{"line":26,"column":22}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":27,"column":31},"generated":{"line":26,"column":23}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":27,"column":35},"generated":{"line":26,"column":27}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":27,"column":51},"generated":{"line":26,"column":61}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":27,"column":52},"generated":{"line":26,"column":62}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":27,"column":59},"generated":{"line":26,"column":69}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":27,"column":61},"generated":{"line":26,"column":71}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":27,"column":66},"generated":{"line":26,"column":76}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":27,"column":67},"generated":{"line":26,"column":77}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":27,"column":68},"generated":{"line":26,"column":78}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":28,"column":8},"generated":{"line":27,"column":2}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":28,"column":9},"generated":{"line":27,"column":3}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":30,"column":8},"generated":{"line":28,"column":2}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":31,"column":8},"generated":{"line":29,"column":2}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":32,"column":8},"generated":{"line":30,"column":2}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":33,"column":8},"generated":{"line":31,"column":2}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":34,"column":8},"generated":{"line":32,"column":2}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":35,"column":8},"generated":{"line":33,"column":2}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":35,"column":12},"generated":{"line":33,"column":6}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":35,"column":23},"generated":{"line":33,"column":17}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":35,"column":26},"generated":{"line":33,"column":20}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":35,"column":31},"generated":{"line":33,"column":25}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":36,"column":8},"generated":{"line":34,"column":2}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":36,"column":12},"generated":{"line":34,"column":6}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":36,"column":13},"generated":{"line":34,"column":7}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":36,"column":29},"generated":{"line":34,"column":23}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":36,"column":32},"generated":{"line":34,"column":26}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":36,"column":36},"generated":{"line":34,"column":30}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":36,"column":41},"generated":{"line":34,"column":35}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":36,"column":42},"generated":{"line":34,"column":36}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":36,"column":46},"generated":{"line":34,"column":40}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":36,"column":47},"generated":{"line":34,"column":41}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":36,"column":63},"generated":{"line":34,"column":57}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":36,"column":65},"generated":{"line":34,"column":59}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":37,"column":12},"generated":{"line":35,"column":4}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":37,"column":17},"generated":{"line":35,"column":9}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":37,"column":19},"generated":{"line":35,"column":11}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":37,"column":20},"generated":{"line":35,"column":12}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":37,"column":26},"generated":{"line":35,"column":18}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":37,"column":28},"generated":{"line":35,"column":20}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":37,"column":35},"generated":{"line":35,"column":27}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":37,"column":37},"generated":{"line":35,"column":29}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":37,"column":88},"generated":{"line":35,"column":33}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":37,"column":92},"generated":{"line":35,"column":38}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":38,"column":16},"generated":{"line":36,"column":6}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":38,"column":20},"generated":{"line":36,"column":10}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":38,"column":31},"generated":{"line":36,"column":21}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":39,"column":20},"generated":{"line":36,"column":23}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":39,"column":26},"generated":{"line":36,"column":29}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":39,"column":30},"generated":{"line":36,"column":33}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":39,"column":35},"generated":{"line":36,"column":38}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":40,"column":24},"generated":{"line":36,"column":39}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":40,"column":104},"generated":{"line":36,"column":119}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":41,"column":28},"generated":{"line":36,"column":122}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":41,"column":89},"generated":{"line":36,"column":183}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":42,"column":21},"generated":{"line":36,"column":184}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":43,"column":16},"generated":{"line":37,"column":6}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":43,"column":27},"generated":{"line":37,"column":17}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":43,"column":30},"generated":{"line":37,"column":20}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":43,"column":34},"generated":{"line":37,"column":24}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":44,"column":16},"generated":{"line":38,"column":6}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":44,"column":26},"generated":{"line":38,"column":16}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":44,"column":27},"generated":{"line":38,"column":17}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":44,"column":34},"generated":{"line":38,"column":24}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":44,"column":36},"generated":{"line":38,"column":25}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":44,"column":45},"generated":{"line":38,"column":34}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":44,"column":50},"generated":{"line":38,"column":38}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":44,"column":56},"generated":{"line":38,"column":44}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":44,"column":57},"generated":{"line":38,"column":45}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":44,"column":73},"generated":{"line":38,"column":61}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":44,"column":74},"generated":{"line":38,"column":62}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":44,"column":83},"generated":{"line":38,"column":71}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":44,"column":85},"generated":{"line":38,"column":73}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":44,"column":93},"generated":{"line":38,"column":81}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":44,"column":94},"generated":{"line":38,"column":82}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":44,"column":95},"generated":{"line":38,"column":83}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":45,"column":16},"generated":{"line":39,"column":6}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":45,"column":22},"generated":{"line":39,"column":12}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":45,"column":23},"generated":{"line":39,"column":13}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":45,"column":28},"generated":{"line":39,"column":18}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":45,"column":29},"generated":{"line":39,"column":19}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":45,"column":36},"generated":{"line":39,"column":26}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":45,"column":38},"generated":{"line":39,"column":28}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":45,"column":42},"generated":{"line":39,"column":32}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":45,"column":43},"generated":{"line":39,"column":33}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":46,"column":12},"generated":{"line":40,"column":4}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":47,"column":9},"generated":{"line":41,"column":3}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":47,"column":10},"generated":{"line":41,"column":4}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":48,"column":8},"generated":{"line":42,"column":2}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":48,"column":12},"generated":{"line":42,"column":6}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":48,"column":13},"generated":{"line":42,"column":7}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":48,"column":32},"generated":{"line":42,"column":26}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":48,"column":35},"generated":{"line":42,"column":29}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":48,"column":39},"generated":{"line":42,"column":33}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":48,"column":44},"generated":{"line":42,"column":38}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":48,"column":45},"generated":{"line":42,"column":39}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":48,"column":49},"generated":{"line":42,"column":43}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":48,"column":50},"generated":{"line":42,"column":44}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":48,"column":69},"generated":{"line":42,"column":63}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":48,"column":71},"generated":{"line":42,"column":65}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":49,"column":12},"generated":{"line":43,"column":4}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":49,"column":17},"generated":{"line":43,"column":9}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":49,"column":19},"generated":{"line":43,"column":11}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":49,"column":20},"generated":{"line":43,"column":12}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":49,"column":26},"generated":{"line":43,"column":18}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":49,"column":28},"generated":{"line":43,"column":20}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":49,"column":35},"generated":{"line":43,"column":27}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":49,"column":37},"generated":{"line":43,"column":29}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":49,"column":91},"generated":{"line":43,"column":33}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":49,"column":95},"generated":{"line":43,"column":38}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":50,"column":16},"generated":{"line":44,"column":6}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":50,"column":26},"generated":{"line":44,"column":16}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":50,"column":27},"generated":{"line":44,"column":17}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":50,"column":34},"generated":{"line":44,"column":24}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":50,"column":36},"generated":{"line":44,"column":25}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":50,"column":45},"generated":{"line":44,"column":34}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":50,"column":50},"generated":{"line":44,"column":38}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":50,"column":56},"generated":{"line":44,"column":44}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":50,"column":57},"generated":{"line":44,"column":45}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":50,"column":76},"generated":{"line":44,"column":64}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":50,"column":77},"generated":{"line":44,"column":65}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":50,"column":86},"generated":{"line":44,"column":74}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":50,"column":88},"generated":{"line":44,"column":76}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":50,"column":96},"generated":{"line":44,"column":84}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":50,"column":97},"generated":{"line":44,"column":85}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":50,"column":98},"generated":{"line":44,"column":86}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":51,"column":16},"generated":{"line":45,"column":6}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":51,"column":22},"generated":{"line":45,"column":12}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":51,"column":23},"generated":{"line":45,"column":13}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":51,"column":28},"generated":{"line":45,"column":18}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":51,"column":29},"generated":{"line":45,"column":19}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":51,"column":36},"generated":{"line":45,"column":26}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":51,"column":38},"generated":{"line":45,"column":28}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":51,"column":42},"generated":{"line":45,"column":32}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":51,"column":43},"generated":{"line":45,"column":33}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":52,"column":12},"generated":{"line":46,"column":4}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":53,"column":9},"generated":{"line":47,"column":3}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":53,"column":10},"generated":{"line":47,"column":4}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":55,"column":8},"generated":{"line":48,"column":2}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":55,"column":15},"generated":{"line":48,"column":9}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":55,"column":19},"generated":{"line":48,"column":13}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":56,"column":4},"generated":{"line":49,"column":0}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":56,"column":5},"generated":{"line":49,"column":1}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":56,"column":6},"generated":{"line":50,"column":0}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":56,"column":6},"generated":{"line":50,"column":7}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":56,"column":6},"generated":{"line":50,"column":8}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":56,"column":6},"generated":{"line":50,"column":12}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":56,"column":6},"generated":{"line":50,"column":15}},{"source":"../../src/events/scan.ts","name":null,"original":{"line":56,"column":6},"generated":{"line":50,"column":19}}],"sources":{"../../src/events/scan.ts":"import { EventOfType, TypedCustomEvent } from \"./TypedCustomEvent\";\nimport { EventsFromTarget, TypedEventTarget } from \"./TypedEventTarget\";\n\n/**\n * Each time an event is emitted, call a given accumulator function with two arguments: some state of type S and the\n * event. The accumulator returns a new state. `scan` returns a new event emitter which emits an event each time a new\n * state is produced by the accumulator.\n *\n * This can be used to implement a Redux-style state management architecture.\n *\n * @param seedState Some initial state, passed to the accumulator when the first event is emitted.\n * @returns A function which takes a source {@link TypedEventTarget}, a list of event types emitted by that target to\n * which to listen, and the accumulator function. The accumulator is called each time an event of the given type(s) is\n * emitted on the source. It is passed the current state and the event, and must return a new state.\n */\nexport const scan =\n    <S>(seedState: S) =>\n    <Target extends TypedEventTarget, Events extends EventsFromTarget<Target>, EventType extends Events[\"type\"]>(\n        source: Target,\n        eventTypes: EventType[],\n        accumulator: (state: S, event: EventOfType<EventType, Events>) => S\n    ): TypedEventTarget<TypedCustomEvent<\"state\", S>> => {\n        let state = seedState;\n        const sink = new TypedEventTarget<TypedCustomEvent<\"state\", S>>();\n        const listener = (event: TypedCustomEvent) => {\n            state = accumulator(state, event as EventOfType<EventType, Events>);\n            sink.dispatchEvent(new TypedCustomEvent(\"state\", state));\n        };\n\n        // We'll use Proxies to make sure that event listeners are added/removed at the appropriate time.\n        // Callers can then control when to clean up the listeners we add here in a transparent way –\n        // by just removing the listener on the returned event target.\n        //\n        // We also prevent multiple listeners on the sink, as a simplification.\n        let hasListener = false;\n        sink.addEventListener = new Proxy(sink.addEventListener, {\n            apply: (target, thisArg, args: Parameters<(typeof sink)[\"addEventListener\"]>) => {\n                if (hasListener)\n                    throw new Error(\n                        \"Cannot add another event listener. The TypedEventTarget returned by scan only \" +\n                            \"supports a single listener, and one has already been added.\"\n                    );\n                hasListener = true;\n                eventTypes.forEach((eventType) => source.addEventListener(eventType, listener));\n                target.apply(thisArg, args);\n            },\n        });\n        sink.removeEventListener = new Proxy(sink.removeEventListener, {\n            apply: (target, thisArg, args: Parameters<(typeof sink)[\"removeEventListener\"]>) => {\n                eventTypes.forEach((eventType) => source.removeEventListener(eventType, listener));\n                target.apply(thisArg, args);\n            },\n        });\n\n        return sink;\n    };\n"},"lineCount":null}},"error":null,"hash":"f253160058553c94f6331fd794308124","cacheData":{"env":{}}}